import { useState } from "react";
import { Button, Modal } from "react-bootstrap";
import InsertCSVForm from "../InsertCSVForm/InsertCSVForm";
import InsertForm from "../InsertForm/InsertForm";
import "./InsertModal.css";

interface InsertModalProps {
  visible?: boolean;
  setIsVisible: (active: boolean) => void;
}

function InsertModal({ visible = false, setIsVisible }: InsertModalProps) {
  const [isButtonsVisible, setIsButtonsVisible] = useState<boolean>(true);
  const [isManualFormVisible, setIsManualFormVisible] =
    useState<boolean>(false);
  const [isCSVFormVisible, setIsCSVFormVisible] = useState<boolean>(false);

  const handleInsertManually = () => {
    setIsButtonsVisible(false);
    setIsManualFormVisible(true);
  };

  const handleInsertCSV = () => {
    setIsButtonsVisible(false);
    setIsCSVFormVisible(true);
  };

  const handleCloseForms = () => {
    setIsManualFormVisible(false);
    setIsCSVFormVisible(false);
    setIsButtonsVisible(true);
  };

  return (
    <Modal className="insert-modal" show={visible} centered>
      <Modal.Header className="justify-content-center">
        <h2>Registrar Vulnerabilidades</h2>
      </Modal.Header>

      <Modal.Body>
        <div className="insert-button-container" hidden={!isButtonsVisible}>
          <Button onClick={handleInsertManually} variant="outline-secondary">
            Inserir Manualmente
          </Button>
          <Button onClick={handleInsertCSV} variant="outline-secondary">
            Importar CSV
          </Button>
        </div>

        <InsertForm visible={isManualFormVisible} onHiding={handleCloseForms} />

        <InsertCSVForm visible={isCSVFormVisible} onHiding={handleCloseForms} />
      </Modal.Body>

      <Modal.Footer>
        <Button variant="secondary" onClick={(e) => setIsVisible(false)}>
          Fechar
        </Button>
      </Modal.Footer>
    </Modal>
  );
}

export default InsertModal;
